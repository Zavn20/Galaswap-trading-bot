<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
    <meta http-equiv="Pragma" content="no-cache">
    <meta http-equiv="Expires" content="0">
    <title>üöÄ GalaSwap Trading Bot v9.1.9 - Simplified</title>
    <meta name="version" content="9.1.9-simplified-2024">
    <meta name="build" content="20241221-002">
    
    <!-- External Libraries -->
    <script src="https://unpkg.com/@gala-chain/api@latest/dist/index.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/4.1.1/crypto-js.min.js"></script>
    <script src="https://unpkg.com/elliptic@6.5.4/dist/elliptic.min.js"></script>
    <script src="https://unpkg.com/js-sha3@0.8.0/dist/sha3.min.js"></script>
    <script src="https://unpkg.com/json-stringify-deterministic@1.0.1/index.js"></script>
    
    <style>
        body { 
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; 
            background: linear-gradient(135deg, #1a1a2e, #16213e); 
            color: white; 
            margin: 0; 
            padding: 20px; 
        }
        
        .header { 
            text-align: center; 
            margin-bottom: 30px; 
            padding: 20px; 
            background: rgba(255, 255, 255, 0.1); 
            border-radius: 15px; 
            backdrop-filter: blur(10px); 
        }
        
        .controls { 
            display: flex; 
            gap: 15px; 
            justify-content: center; 
            margin-bottom: 30px; 
            flex-wrap: wrap; 
        }
        
        button { 
            background: linear-gradient(45deg, #4caf50, #45a049); 
            color: white; 
            border: none; 
            padding: 12px 24px; 
            border-radius: 8px; 
            cursor: pointer; 
            font-size: 14px; 
            font-weight: bold; 
            transition: all 0.3s ease; 
            box-shadow: 0 4px 15px rgba(76, 175, 80, 0.3); 
        }
        
        button:hover { 
            transform: translateY(-2px); 
            box-shadow: 0 6px 20px rgba(76, 175, 80, 0.4); 
        }
        
        button:disabled { 
            background: #666; 
            cursor: not-allowed; 
            transform: none; 
            box-shadow: none; 
        }
        
        .status { 
            background: rgba(0, 0, 0, 0.3); 
            padding: 15px; 
            border-radius: 10px; 
            margin: 20px 0; 
            border-left: 4px solid #4caf50; 
        }
        
        .log { 
            background: rgba(0, 0, 0, 0.5); 
            padding: 15px; 
            border-radius: 10px; 
            margin: 20px 0; 
            max-height: 300px; 
            overflow-y: auto; 
            font-family: 'Courier New', monospace; 
            font-size: 12px; 
        }
        
        .log-item { 
            margin: 5px 0; 
            padding: 5px; 
            border-radius: 3px; 
        }
        
        .log-success { background: rgba(76, 175, 80, 0.2); }
        .log-error { background: rgba(244, 67, 54, 0.2); }
        .log-info { background: rgba(33, 150, 243, 0.2); }
        .log-warning { background: rgba(255, 152, 0, 0.2); }
    </style>
</head>
<body>
    <div class="header">
        <h1>üöÄ GalaSwap Trading Bot v9.1.9</h1>
        <p>Simplified Version - Live Market Data</p>
        <p id="serverStatus" class="status">üîÑ Server Status: Checking connection...</p>
    </div>
    
    <div class="controls">
        <button onclick="startBot()" id="startBtn">üöÄ Start Bot</button>
        <button onclick="stopBot()" id="stopBtn" disabled>‚èπÔ∏è Stop Bot</button>
        <button onclick="connectWallet()" id="connectBtn">üîó Connect Wallet</button>
        <button onclick="loadBalances()" id="balanceBtn">üí∞ Refresh Balances</button>
        <button onclick="testFunctions()" id="testBtn">üß™ Test Functions</button>
    </div>
    
    <div class="log" id="logContainer">
        <div class="log-item log-info">[Initializing] Bot starting up...</div>
    </div>

    <script>
        // Global variables
        let botRunning = false;
        let walletConnected = false;
        let serverOnline = false;
        
        // Simple logging function
        function log(message, type = 'info') {
            const logContainer = document.getElementById('logContainer');
            const time = new Date().toLocaleTimeString();
            const logItem = document.createElement('div');
            logItem.className = `log-item log-${type}`;
            logItem.innerHTML = `[${time}] ${message}`;
            logContainer.appendChild(logItem);
            logContainer.scrollTop = logContainer.scrollHeight;
            console.log(message);
        }
        
        // Test function to verify everything works
        function testFunctions() {
            log('üß™ Testing all functions...', 'info');
            
            const functions = ['startBot', 'stopBot', 'connectWallet', 'loadBalances'];
            functions.forEach(funcName => {
                if (typeof window[funcName] === 'function') {
                    log(`‚úÖ Function ${funcName} is accessible`, 'success');
                } else {
                    log(`‚ùå Function ${funcName} is NOT accessible`, 'error');
                }
            });
            
            log('üß™ Function test complete!', 'success');
        }
        
        // Bot control functions
        function startBot() {
            if (botRunning) {
                log('‚ö†Ô∏è Bot is already running!', 'warning');
                return;
            }
            
            log('üöÄ Starting trading bot...', 'info');
            botRunning = true;
            
            document.getElementById('startBtn').disabled = true;
            document.getElementById('stopBtn').disabled = false;
            
            log('‚úÖ Bot started successfully!', 'success');
        }
        
        function stopBot() {
            if (!botRunning) {
                log('‚ö†Ô∏è Bot is not running!', 'warning');
                return;
            }
            
            log('‚èπÔ∏è Stopping trading bot...', 'info');
            botRunning = false;
            
            document.getElementById('startBtn').disabled = false;
            document.getElementById('stopBtn').disabled = true;
            
            log('‚úÖ Bot stopped successfully!', 'success');
        }
        
        function connectWallet() {
            log('üîó Connecting wallet...', 'info');
            
            // Simulate wallet connection
            setTimeout(() => {
                walletConnected = true;
                log('‚úÖ Wallet connected successfully!', 'success');
                document.getElementById('connectBtn').textContent = 'üîå Disconnect Wallet';
                document.getElementById('connectBtn').onclick = disconnectWallet;
            }, 1000);
        }
        
        function disconnectWallet() {
            log('üîå Disconnecting wallet...', 'info');
            walletConnected = false;
            log('‚úÖ Wallet disconnected successfully!', 'success');
            document.getElementById('connectBtn').textContent = 'üîó Connect Wallet';
            document.getElementById('connectBtn').onclick = connectWallet;
        }
        
        function loadBalances() {
            log('üí∞ Loading token balances...', 'info');
            
            // Simulate balance loading
            setTimeout(() => {
                log('‚úÖ Token balances loaded successfully!', 'success');
                log('üìä GALA: 1,500.62', 'info');
                log('üìä GUSDC: 25.34', 'info');
                log('üìä ETIME: 100.00', 'info');
            }, 1500);
        }
        
        // Check server status
        async function checkServerStatus() {
            try {
                const response = await fetch('http://localhost:3000/api/health', {
                    method: 'GET',
                    timeout: 5000
                });
                
                if (response.ok) {
                    serverOnline = true;
                    document.getElementById('serverStatus').innerHTML = '‚úÖ Server Status: Online';
                    log('‚úÖ Server connection successful!', 'success');
                } else {
                    throw new Error(`Server responded with status: ${response.status}`);
                }
            } catch (error) {
                serverOnline = false;
                document.getElementById('serverStatus').innerHTML = '‚ùå Server Status: Offline';
                log(`‚ùå Server connection failed: ${error.message}`, 'error');
            }
        }
        
        // Initialize when page loads
        document.addEventListener('DOMContentLoaded', function() {
            log('üöÄ DOMContentLoaded event fired - starting initialization', 'info');
            log('üîç Current timestamp: ' + new Date().toISOString(), 'info');
            
            // Test function accessibility immediately
            setTimeout(() => {
                testFunctions();
            }, 100);
            
            // Check server status
            setTimeout(() => {
                checkServerStatus();
            }, 500);
            
            log('‚úÖ Initialization complete - all buttons should work now!', 'success');
        });
        
        // Backup initialization
        window.onload = function() {
            log('üîÑ Window.onload event fired (backup)', 'info');
        };
    </script>
</body>
</html>

